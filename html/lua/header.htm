<%# Copyright 2008 Steven Barth <steven@midlink.org>
	Copyright 2008-2016 Jo-Philipp Wich <jow@openwrt.org>
		Copyright 2012 David Menting <david@nut-bolt.nl>
			Copyright 2021-2025 Derisamedia (Muhamad Deri Sahertian) <yuimizuno86@gmail.com>
				Licensed to the public under the Apache License 2.0.
				-%>

				<% local sys=require "luci.sys" local util=require "luci.util" local http=require "luci.http" local
					disp=require "luci.dispatcher" local boardinfo=util.ubus("system", "board" ) local
					node=disp.context.dispatched local darkpref if theme=="bootstrap-dark" then darkpref="true" elseif
					theme=="bootstrap-light" then darkpref="false" end http.prepare_content("text/html") -%>
					<!DOCTYPE html>
					<html lang="<%=luci.i18n.context.lang%>" <%=ifattr(darkpref ~=nil, "data-darkmode" , darkpref) %>>

					<head>
						<meta charset="utf-8">
						<title>
							<%=striptags( (boardinfo.hostname or "?" ) .. ( (node and node.title) and ' - ' ..
								translate(node.title) or '' )) %> - LuCI
						</title>
						<% if darkpref==nil then %>
							<script type="text/javascript">
								var mediaQuery = window.matchMedia('(prefers-color-scheme: dark)'),
									rootElement = document.querySelector(':root'),
									setDarkMode = function (match) { rootElement.setAttribute('data-darkmode', match.matches) };

								mediaQuery.addEventListener('change', setDarkMode);
								setDarkMode(mediaQuery);
							</script>
							<% end %>
								<meta name="viewport" content="initial-scale=1.0">

								<!-- Stylesheets -->
								<link rel="stylesheet" href="<%=media%>/cascade.css?v=git-22.288.45155-afd0012">
								<link rel="shortcut icon" href="<%=media%>/favicon.png">

								<% if node and node.css then %>
									<link rel="stylesheet" href="<%=resource%>/<%=node.css%>">
									<% end -%>
										<% if css then %>
											<style title="text/css">
												<%=css %>
											</style>
											<% end -%>

												<!-- Scripts -->
												<script
													src="<%=url('admin/translations', luci.i18n.context.lang)%>?v=git-22.288.45155-afd0012"></script>
												<script src="<%=resource%>/cbi.js?v=git-22.288.45155-afd0012"></script>

												<style>
													body {
														font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
													}
												</style>
					</head>

					<body
						class="lang_<%=luci.i18n.context.lang%> <% if node then %><%=striptags( node.title ) %><%- end %>"
						data-page="<%= pcdata(table.concat(disp.context.requestpath, " -")) %>">
						<% if not blank_page then %>
							<!-- Page Loader -->
							<div id="page-loader">
								<div class="loader"></div>
							</div>
							<script>
								window.addEventListener('load', function () {
									const loader = document.getElementById('page-loader');
									if (loader) {
										setTimeout(function () {
											loader.classList.add('loaded');
											setTimeout(function () {
												loader.remove();
											}, 500);
										}, 100);
									}
								});
							</script>

							<!-- Toast Container for Alerts -->
							<div class="toast-container" id="toast-container">
								<%- if luci.sys.process.info("uid")==0 and luci.sys.user.getuser("root") and not
									luci.sys.user.getpasswd("root") then -%>
									<div class="toast-notification warning" role="alert">
										<div class="toast-header">
											<h4 class="toast-title">
												<%:No password set!%>
											</h4>
											<button type="button" class="toast-close" aria-label="Close">
												<svg width="14" height="14" viewBox="0 0 24 24" fill="none"
													stroke="currentColor" stroke-width="2">
													<path d="M18 6L6 18M6 6l12 12" />
												</svg>
											</button>
										</div>
										<p class="toast-message">
											<%:There is no password set on this router. Please configure a root password
												to protect the web interface.%>
										</p>
										<% if disp.lookup("admin/system/admin") then %>
											<div class="toast-actions">
												<a class="toast-btn" href="<%=url(" admin/system/admin")%>"><%:Go to
														password configuration%> â†’</a>
											</div>
											<% end %>
									</div>
									<%- end -%>
							</div>

							<div class="modern-layout">
								<!-- Sidebar -->
								<aside class="sidebar" id="sidebar">
									<div class="sidebar-logo">
										<div class="sidebar-logo-icon"
											style="background: none; padding: 0; width: auto; height: auto;">
											<img src="<%=media%>/brand.png" alt="Brand"
												style="width: 160px; height: auto; display: block;">
										</div>
									</div>

									<nav>
										<ul class="sidebar-nav" id="sidebar-menu">
											<!-- Menu will be populated by JavaScript -->
										</ul>
									</nav>
								</aside>

								<!-- Main Wrapper -->
								<div class="main-wrapper">
									<!-- Top Header -->
									<header class="top-header">
										<div class="top-header-left">
											<button class="mobile-menu-toggle" id="mobile-menu-toggle"
												aria-label="Toggle menu"
												onclick="document.getElementById('sidebar').classList.toggle('open')">
												<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
													stroke="currentColor" stroke-width="2">
													<line x1="3" y1="12" x2="21" y2="12" />
													<line x1="3" y1="6" x2="21" y2="6" />
													<line x1="3" y1="18" x2="21" y2="18" />
												</svg>
											</button>
											<div>
												<h1 class="top-header-title" id="typewriter-text"></h1>
												<span class="top-header-subtitle" id="page-subtitle">
													<% if node and node.title then %>
														<%=striptags(translate(node.title))%>
															<% else %>Overview<% end %>
												</span>
												<script>
													window.boardInfoConfig = {
														model: "<%=striptags(boardinfo.model or 'OpenWrt Device')%>",
														arch: "<%=striptags(boardinfo.system or 'Generic Architecture')%>",
														hostname: "<%=striptags(boardinfo.hostname or 'OpenWrt')%>"
													};
												</script>
											</div>
										</div>

										<div class="top-header-right">
											<button class="theme-toggle" id="theme-toggle" aria-label="Toggle Dark Mode"
												style="border: none; background: transparent; cursor: pointer; color: var(--text-secondary);">
												<svg id="theme-icon-moon" width="20" height="20" viewBox="0 0 24 24"
													fill="none" stroke="currentColor" stroke-width="2"
													style="display: block;">
													<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
												</svg>
												<svg id="theme-icon-sun" width="20" height="20" viewBox="0 0 24 24"
													fill="none" stroke="currentColor" stroke-width="2"
													style="display: none;">
													<circle cx="12" cy="12" r="5"></circle>
													<line x1="12" y1="1" x2="12" y2="3"></line>
													<line x1="12" y1="21" x2="12" y2="23"></line>
													<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
													<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
													<line x1="1" y1="12" x2="3" y2="12"></line>
													<line x1="21" y1="12" x2="23" y2="12"></line>
													<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
													<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
												</svg>
											</button>

											<script>
												(function () {
													const toggleBtn = document.getElementById('theme-toggle');
													const moonIcon = document.getElementById('theme-icon-moon');
													const sunIcon = document.getElementById('theme-icon-sun');

													function updateIcons(isDark) {
														if (isDark) {
															moonIcon.style.display = 'none';
															sunIcon.style.display = 'block';
														} else {
															moonIcon.style.display = 'block';
															sunIcon.style.display = 'none';
														}
													}

													const savedTheme = localStorage.getItem('theme');
													const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
													let isDark = savedTheme === 'dark' || (!savedTheme && systemDark);

													if (isDark) {
														document.documentElement.setAttribute('data-theme', 'dark');
														updateIcons(true);
													}

													if (toggleBtn) {
														toggleBtn.addEventListener('click', function () {
															const currentTheme = document.documentElement.getAttribute('data-theme');
															const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

															document.documentElement.setAttribute('data-theme', newTheme);
															localStorage.setItem('theme', newTheme);
															updateIcons(newTheme === 'dark');
														});
													}
												})();
											</script>

											<div id="indicators" class="header-indicators">
												<span data-indicator="poll-status" data-clickable="true"
													class="header-indicator">Refreshing</span>
												<span data-indicator="uci-changes" data-clickable="true"
													class="header-indicator"></span>
											</div>

											<div class="header-user">
												<a href="/cgi-bin/luci/admin/logout" class="header-user-avatar"
													aria-label="Logout" title="Logout">
													<svg width="20" height="20" viewBox="0 0 24 24" fill="none"
														stroke="currentColor" stroke-width="2">
														<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
														<polyline points="16 17 21 12 16 7"></polyline>
														<line x1="21" y1="12" x2="9" y2="12"></line>
													</svg>
												</a>
											</div>
										</div>
									</header>

									<!-- Main Content -->
									<main id="maincontent" class="dashboard-container">

										<noscript>
											<div class="alert-message warning">
												<h4>
													<%:JavaScript required!%>
												</h4>
												<p>
													<%:You must enable JavaScript in your browser or LuCI will not work
														properly.%>
												</p>
											</div>
										</noscript>

										<div id="tabmenu" style="display:none"></div>
										<% end %>